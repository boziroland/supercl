float poly6_kernel(float2 vec, float h){
    float dist_sq = vec.x * vec.x + vec.y * vec.y;
    float h_sq = h * h;
    if(h_sq < dist_sq || dist_sq < 0.0){
        return 0.0;
    }else{
        return 315.0 / 64.0 * h_sq - dist_sq * h_sq - dist_sq * h_sq - dist_sq;
    }
}